# –î–æ–º–∞—à–Ω—è—è –∫–æ–Ω—Ç—Ä–æ–ª—å–Ω–∞—è —Ä–∞–±–æ—Ç–∞ ‚Ññ3
## –û–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ –æ–±—ä–µ–∫—Ç–æ–≤ –≤ –≤–∏–¥–µ–æ–ø–æ—Ç–æ–∫–µ

–†–µ–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–æ–≥—Ä–∞–º–º—ã –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏—è –æ–±—ä–µ–∫—Ç–æ–≤ –≤ –≤–∏–¥–µ–æ–ø–æ—Ç–æ–∫–µ –Ω–∞ –æ—Å–Ω–æ–≤–µ –Ω–µ–π—Ä–æ–Ω–Ω–æ–π —Å–µ—Ç–∏ YOLOv8n —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º Transfer Learning.

---

## üìã –û–ø–∏—Å–∞–Ω–∏–µ

–ü—Ä–æ–µ–∫—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω –≤ —Ä–∞–º–∫–∞—Ö –¥–æ–º–∞—à–Ω–µ–≥–æ –∑–∞–¥–∞–Ω–∏—è –ø–æ –∫–æ–º–ø—å—é—Ç–µ—Ä–Ω–æ–º—É –∑—Ä–µ–Ω–∏—é. –í–∫–ª—é—á–∞–µ—Ç:
- –ü–æ–¥–≥–æ—Ç–æ–≤–∫—É –≤–∏–¥–µ–æ–¥–∞–Ω–Ω—ã—Ö –∏ –∏–∑–≤–ª–µ—á–µ–Ω–∏–µ —Ñ—Ä–µ–π–º–æ–≤
- –û–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏ **YOLOv8n** —Å Transfer Learning (‚ö° –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–æ –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ –æ–±—É—á–µ–Ω–∏—è)
- –ê–Ω–∞–ª–∏–∑ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ —Å –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏–µ–º –≥—Ä–∞—Ñ–∏–∫–æ–≤ –∏ –º–µ—Ç—Ä–∏–∫
- –û–±—Ä–∞–±–æ—Ç–∫—É –≤–∏–¥–µ–æ–ø–æ—Ç–æ–∫–∞ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏

## üéØ –ö–ª–∞—Å—Å—ã –¥–ª—è –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏—è

–í—ã–±—Ä–∞–Ω—ã —Ç–æ–ø-5 –∫–ª–∞—Å—Å–æ–≤ –∏–∑ –¥–∞—Ç–∞—Å–µ—Ç–∞ **ExDark**:

1. **People** - —á–µ–ª–æ–≤–µ–∫ (6432 –æ–±—ä–µ–∫—Ç–∞)
2. **car** - –∞–≤—Ç–æ–º–æ–±–∏–ª—å (3117 –æ–±—ä–µ–∫—Ç–æ–≤)
3. **chair** - —Å—Ç—É–ª (2498 –æ–±—ä–µ–∫—Ç–æ–≤)
4. **Table** - —Å—Ç–æ–ª (1722 –æ–±—ä–µ–∫—Ç–∞)
5. **Bottle** - –±—É—Ç—ã–ª–∫–∞ (1528 –æ–±—ä–µ–∫—Ç–æ–≤)

## üìä –î–∞—Ç–∞—Å–µ—Ç

**–ò—Å—Ç–æ—á–Ω–∏–∫:** ExDark dataset (—á–µ—Ä–µ–∑ Roboflow)
- **Train:** 3300 –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π, 10828 –æ–±—ä–µ–∫—Ç–æ–≤
- **Val:** 940 –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π, 3033 –æ–±—ä–µ–∫—Ç–∞
- **Test:** 478 –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π, 1436 –æ–±—ä–µ–∫—Ç–æ–≤

## üèóÔ∏è –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

**YOLOv8n (Nano)** - –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–∞ –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ –æ–±—É—á–µ–Ω–∏—è (~1 —á–∞—Å)

### –•–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏:
- **–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:** ~3.2M (–≤ 3.5x –ª–µ–≥—á–µ —á–µ–º YOLOv8s)
- **VRAM:** ~1.2GB
- **FPS –ø—Ä–∏ inference:** 80-100
- **–í—Ä–µ–º—è –æ–±—É—á–µ–Ω–∏—è:** ~60-80 –º–∏–Ω—É—Ç (25 —ç–ø–æ—Ö)

### –ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã:
- **Backbone:** CSPDarknet (–∏–∑–≤–ª–µ—á–µ–Ω–∏–µ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤)
- **Neck:** FPN + PAN (Feature Pyramid Network)
- **Head:** Decoupled detection head (–∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è + bbox regression)
- **NMS:** Non-Maximum Suppression (–≤—Å—Ç—Ä–æ–µ–Ω)

### –§—É–Ω–∫—Ü–∏–∏ –ø–æ—Ç–µ—Ä—å:
1. **Box Loss (CIoU)** - Complete IoU –¥–ª—è —Ä–µ–≥—Ä–µ—Å—Å–∏–∏ bbox
2. **Class Loss (BCE)** - Binary Cross-Entropy –¥–ª—è –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏
3. **DFL Loss** - Distribution Focal Loss –¥–ª—è —Ç–æ—á–Ω–æ–π –ª–æ–∫–∞–ª–∏–∑–∞—Ü–∏–∏

---

## üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### 1. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π

```bash
pip install ultralytics opencv-python pandas matplotlib seaborn torch torchvision
```

–ò–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ `requirements.txt`:

```bash
pip install -r requirements.txt
```

### 2. –î–∞—Ç–∞—Å–µ—Ç —É–∂–µ –ø–æ–¥–≥–æ—Ç–æ–≤–ª–µ–Ω!

–î–∞—Ç–∞—Å–µ—Ç ExDark –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –≤ –ø–∞–ø–∫–µ `dataset/` –∏ –≥–æ—Ç–æ–≤ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é.

**–°—Ç—Ä—É–∫—Ç—É—Ä–∞:**
```
dataset/
‚îú‚îÄ‚îÄ images/
‚îÇ   ‚îú‚îÄ‚îÄ train/    # 3300 –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
‚îÇ   ‚îú‚îÄ‚îÄ val/      # 940 –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
‚îÇ   ‚îî‚îÄ‚îÄ test/     # 478 –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
‚îú‚îÄ‚îÄ labels/       # –ê–Ω–Ω–æ—Ç–∞—Ü–∏–∏ –≤ —Ñ–æ—Ä–º–∞—Ç–µ YOLO
‚îî‚îÄ‚îÄ data.yaml     # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
```

### 3. –ó–∞–ø—É—Å–∫ –æ–±—É—á–µ–Ω–∏—è

**–û—Ç–∫—Ä–æ–π—Ç–µ:** `homework_3_fast.ipynb` –≤ Jupyter Notebook

**–ò–ª–∏ –∑–∞–ø—É—Å—Ç–∏—Ç–µ —á–µ—Ä–µ–∑ Python:**

```python
from ultralytics import YOLO

# –ó–∞–≥—Ä—É–∑–∫–∞ –º–æ–¥–µ–ª–∏
model = YOLO('yolov8n.pt')

# –û–±—É—á–µ–Ω–∏–µ
results = model.train(
    data='dataset/data.yaml',
    epochs=25,
    batch=16,
    imgsz=384,
    device=0,
    workers=0,  # –í–∞–∂–Ω–æ –¥–ª—è Windows!
    cache=False,
    amp=True
)
```

‚ö†Ô∏è **–î–ª—è Windows + Jupyter:** –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ `workers=0` –∏ `cache=False` –¥–ª—è –∏–∑–±–µ–∂–∞–Ω–∏—è –∑–∞–≤–∏—Å–∞–Ω–∏–π!

---

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
hw_3/
‚îú‚îÄ‚îÄ homework_3_object_detection.ipynb  # –ò—Å—Ö–æ–¥–Ω—ã–π notebook (100 —ç–ø–æ—Ö)
‚îú‚îÄ‚îÄ homework_3_fast.ipynb              # ‚ö° –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–π notebook (25 —ç–ø–æ—Ö)
‚îú‚îÄ‚îÄ requirements.txt                    # –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
‚îú‚îÄ‚îÄ README.md                          # –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
‚îú‚îÄ‚îÄ –ó–∞–¥–∞–Ω–∏–µ.txt                        # –ó–∞–¥–∞–Ω–∏–µ
‚îú‚îÄ‚îÄ –ú–µ—Ç–æ–¥–∏—á–µ—Å–∫–∏–µ —É–∫–∞–∑–∞–Ω–∏—è.txt          # –ú–µ—Ç–æ–¥–∏—á–∫–∞
‚îÇ
‚îú‚îÄ‚îÄ dataset/                           # –î–∞—Ç–∞—Å–µ—Ç ExDark
‚îÇ   ‚îú‚îÄ‚îÄ images/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ train/                     # 3300 –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ val/                       # 940 –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ test/                      # 478 –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
‚îÇ   ‚îú‚îÄ‚îÄ labels/                        # –ê–Ω–Ω–æ—Ç–∞—Ü–∏–∏ (YOLO —Ñ–æ—Ä–º–∞—Ç)
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ train/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ val/
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ test/
‚îÇ   ‚îî‚îÄ‚îÄ data.yaml                      # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
‚îÇ
‚îú‚îÄ‚îÄ runs/                              # –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –æ–±—É—á–µ–Ω–∏—è
‚îÇ   ‚îî‚îÄ‚îÄ detect/
‚îÇ       ‚îî‚îÄ‚îÄ yolov8n_fast/
‚îÇ           ‚îú‚îÄ‚îÄ weights/
‚îÇ           ‚îÇ   ‚îú‚îÄ‚îÄ best.pt            # ‚≠ê –õ—É—á—à–∞—è –º–æ–¥–µ–ª—å
‚îÇ           ‚îÇ   ‚îî‚îÄ‚îÄ last.pt            # –ü–æ—Å–ª–µ–¥–Ω–∏–π checkpoint
‚îÇ           ‚îú‚îÄ‚îÄ results.csv            # –ú–µ—Ç—Ä–∏–∫–∏ –æ–±—É—á–µ–Ω–∏—è
‚îÇ           ‚îî‚îÄ‚îÄ args.yaml              # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –æ–±—É—á–µ–Ω–∏—è
‚îÇ
‚îî‚îÄ‚îÄ outputs/                           # –í—ã—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
    ‚îú‚îÄ‚îÄ plots/                         # –ì—Ä–∞—Ñ–∏–∫–∏
    ‚îú‚îÄ‚îÄ predictions/                   # –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–π
    ‚îî‚îÄ‚îÄ videos/                        # –û–±—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã–µ –≤–∏–¥–µ–æ
```

---

## ‚öôÔ∏è –ì–∏–ø–µ—Ä–ø–∞—Ä–∞–º–µ—Ç—Ä—ã –æ–±—É—á–µ–Ω–∏—è

### –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è:

| –ü–∞—Ä–∞–º–µ—Ç—Ä | –ó–Ω–∞—á–µ–Ω–∏–µ | –û–±–æ—Å–Ω–æ–≤–∞–Ω–∏–µ |
|----------|----------|-------------|
| **Model** | **YOLOv8n** | –õ–µ–≥–∫–∞—è –º–æ–¥–µ–ª—å –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ –æ–±—É—á–µ–Ω–∏—è |
| **Epochs** | **25** | –î–æ—Å—Ç–∞—Ç–æ—á–Ω–æ —Å Transfer Learning (—É—Å–∫–æ—Ä–µ–Ω–∏–µ 4x) |
| **Batch Size** | 16 | –û–ø—Ç–∏–º–∞–ª—å–Ω–æ –¥–ª—è 4GB VRAM |
| **Image Size** | **384** | –£–º–µ–Ω—å—à–µ–Ω–æ —Å 640 (—É—Å–∫–æ—Ä–µ–Ω–∏–µ 2.8x) |
| Optimizer | Adam | –ê–¥–∞–ø—Ç–∏–≤–Ω—ã–π LR –¥–ª—è fine-tuning |
| Learning Rate | 0.001 | –°—Ç–∞–Ω–¥–∞—Ä—Ç –¥–ª—è Transfer Learning |
| Weight Decay | 0.0005 | L2 —Ä–µ–≥—É–ª—è—Ä–∏–∑–∞—Ü–∏—è |
| AMP | True | Mixed Precision - —ç–∫–æ–Ω–æ–º–∏—Ç ~40% VRAM |
| **Workers** | **0** | ‚ö†Ô∏è –î–ª—è Windows + Jupyter (–∏–∑–±–µ–≥–∞–µ—Ç –∑–∞–≤–∏—Å–∞–Ω–∏–π) |
| **Cache** | **False** | ‚ö†Ô∏è –î–ª—è Windows (—Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å) |

### –ê—É–≥–º–µ–Ω—Ç–∞—Ü–∏–∏ (—É–º–µ–Ω—å—à–µ–Ω—ã –¥–ª—è —É—Å–∫–æ—Ä–µ–Ω–∏—è):
- Mosaic: 0.3 (–≤–º–µ—Å—Ç–æ 1.0)
- HSV color jittering: –º–∏–Ω–∏–º–∞–ª—å–Ω–∞—è –∏–Ω—Ç–µ–Ω—Å–∏–≤–Ω–æ—Å—Ç—å
- Horizontal flip: 0.5
- Scale & Translation: —É–º–µ–Ω—å—à–µ–Ω—ã
- Close mosaic: –ø–æ—Å–ª–µ 5 —ç–ø–æ—Ö

### –ò—Ç–æ–≥–æ–≤–æ–µ —É—Å–∫–æ—Ä–µ–Ω–∏–µ:
- **–ò—Å—Ö–æ–¥–Ω–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è:** ~13 —á–∞—Å–æ–≤ (YOLOv8s, 100 —ç–ø–æ—Ö, 640px)
- **–û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–∞—è:** ~60-80 –º–∏–Ω—É—Ç (YOLOv8n, 25 —ç–ø–æ—Ö, 384px)
- **–£—Å–∫–æ—Ä–µ–Ω–∏–µ:** ~10-11x

---

## üìä –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –æ–±—É—á–µ–Ω–∏—è

### –ò—Ç–æ–≥–æ–≤—ã–µ –º–µ—Ç—Ä–∏–∫–∏ (—ç–ø–æ—Ö–∞ 25):

| –ú–µ—Ç—Ä–∏–∫–∞ | –ó–Ω–∞—á–µ–Ω–∏–µ | –û–ø–∏—Å–∞–Ω–∏–µ |
|---------|----------|----------|
| **mAP@0.5** | **56.56%** | ‚≠ê –û—Å–Ω–æ–≤–Ω–∞—è –º–µ—Ç—Ä–∏–∫–∞ –∫–∞—á–µ—Å—Ç–≤–∞ |
| **mAP@0.5:0.95** | **24.82%** | –°—Ç—Ä–æ–≥–∞—è –º–µ—Ç—Ä–∏–∫–∞ (IoU 0.5-0.95) |
| **Precision** | **67.29%** | –¢–æ—á–Ω–æ—Å—Ç—å –¥–µ—Ç–µ–∫—Ü–∏–π |
| **Recall** | **50.12%** | –ü–æ–ª–Ω–æ—Ç–∞ –¥–µ—Ç–µ–∫—Ü–∏–π |

### –ò–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏—è:

‚úÖ **–û—Ç–ª–∏—á–Ω—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã!**
- mAP@0.5 = 56.6% - **–≤—ã—à–µ —á–µ–º —É YOLOv8s –Ω–∞ COCO** (~45%)
- Precision > Recall - –º–æ–¥–µ–ª—å –∫–æ–Ω—Å–µ—Ä–≤–∞—Ç–∏–≤–Ω–∞ (–º–µ–Ω—å—à–µ –ª–æ–∂–Ω—ã—Ö —Å—Ä–∞–±–∞—Ç—ã–≤–∞–Ω–∏–π)
- –ú–æ–¥–µ–ª—å —Ö–æ—Ä–æ—à–æ —Ä–∞–±–æ—Ç–∞–µ—Ç –Ω–∞ –¥–∞—Ç–∞—Å–µ—Ç–µ ExDark

### Loss'—ã (—ç–ø–æ—Ö–∞ 25):
- Train Box Loss: 1.78
- Train Class Loss: 1.48
- Train DFL Loss: 1.60

### –§–∞–π–ª—ã —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤:

1. **–û–±—É—á–µ–Ω–Ω–∞—è –º–æ–¥–µ–ª—å:** `runs/detect/yolov8n_fast/weights/best.pt` (~6.2 MB)
2. **–ú–µ—Ç—Ä–∏–∫–∏ –æ–±—É—á–µ–Ω–∏—è:** `runs/detect/yolov8n_fast/results.csv`
3. **–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è:** `runs/detect/yolov8n_fast/args.yaml`

---

## üé• –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –º–æ–¥–µ–ª–∏

### 1. –ó–∞–≥—Ä—É–∑–∫–∞ –º–æ–¥–µ–ª–∏

```python
from ultralytics import YOLO

# –ó–∞–≥—Ä—É–∑–∫–∞ –ª—É—á—à–µ–π –º–æ–¥–µ–ª–∏
model = YOLO('runs/detect/yolov8n_fast/weights/best.pt')
```

### 2. Inference –Ω–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–∏

```python
# –ü—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–µ
results = model('path/to/image.jpg')

# –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è
results[0].show()

# –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ
results[0].save('output.jpg')
```

### 3. Inference –Ω–∞ –≤–∏–¥–µ–æ

```python
# –û–±—Ä–∞–±–æ—Ç–∫–∞ –≤–∏–¥–µ–æ
results = model('path/to/video.mp4', conf=0.5)

# –ò–ª–∏ —á–µ—Ä–µ–∑ —Ñ—É–Ω–∫—Ü–∏—é –∏–∑ notebook
process_video_stream(
    model=model,
    video_source='video.mp4',
    conf_threshold=0.5,
    iou_threshold=0.5
)
```

### 4. –ö–æ–º–∞–Ω–¥–Ω–∞—è —Å—Ç—Ä–æ–∫–∞

```bash
# –ü—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–µ –Ω–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–∏
yolo predict model=runs/detect/yolov8n_fast/weights/best.pt source=image.jpg

# –ü—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–µ –Ω–∞ –≤–∏–¥–µ–æ
yolo predict model=runs/detect/yolov8n_fast/weights/best.pt source=video.mp4
```

### –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å:
- **GPU RTX 3050 Ti:** ~80-100 FPS (inference)
- **CPU:** ~10-15 FPS (inference)
- **Latency:** ~10-12 –º—Å –Ω–∞ GPU

---

## üîß –†–µ—à–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º

### ‚ö†Ô∏è –ó–∞–≤–∏—Å–∞–Ω–∏–µ –ø—Ä–∏ –æ–±—É—á–µ–Ω–∏–∏ (Windows + Jupyter)

**–ü—Ä–æ–±–ª–µ–º–∞:** –û–±—É—á–µ–Ω–∏–µ –∑–∞–≤–∏—Å–∞–µ—Ç –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ –¥–∞–Ω–Ω—ã—Ö

**–†–µ—à–µ–Ω–∏–µ:**
```python
training_config = {
    'workers': 0,      # ‚ö†Ô∏è –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –≤ 0 –¥–ª—è Windows
    'cache': False,    # ‚ö†Ô∏è –û—Ç–∫–ª—é—á–∏—Ç–µ –¥–ª—è —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç–∏
}
```

**–ü—Ä–∏—á–∏–Ω–∞:** Windows –∏—Å–ø–æ–ª—å–∑—É–µ—Ç `spawn` –≤–º–µ—Å—Ç–æ `fork` –¥–ª—è multiprocessing, —á—Ç–æ –≤—ã–∑—ã–≤–∞–µ—Ç deadlock –≤ Jupyter.

### CUDA Out of Memory

–ï—Å–ª–∏ –≤–æ–∑–Ω–∏–∫–∞–µ—Ç –æ—à–∏–±–∫–∞ –Ω–µ—Ö–≤–∞—Ç–∫–∏ GPU –ø–∞–º—è—Ç–∏:

1. **–£–º–µ–Ω—å—à–∏—Ç—å batch_size:**
   ```python
   batch = 16 ‚Üí batch = 8 ‚Üí batch = 4
   ```

2. **–£–º–µ–Ω—å—à–∏—Ç—å —Ä–∞–∑–º–µ—Ä –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è:**
   ```python
   imgsz = 384 ‚Üí imgsz = 320 ‚Üí imgsz = 256
   ```

3. **–û—Ç–∫–ª—é—á–∏—Ç—å cache:**
   ```python
   cache = False  # –≤–º–µ—Å—Ç–æ 'ram'
   ```

4. **–£–±–µ–¥–∏—Ç—å—Å—è —á—Ç–æ AMP –≤–∫–ª—é—á–µ–Ω:**
   ```python
   amp = True  # Mixed Precision Training
   ```

### –ú–µ–¥–ª–µ–Ω–Ω–æ–µ –æ–±—É—á–µ–Ω–∏–µ

1. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ GPU:**
   ```python
   import torch
   print(torch.cuda.is_available())  # –î–æ–ª–∂–Ω–æ –±—ã—Ç—å True
   print(torch.cuda.get_device_name(0))
   ```

2. **–£–∂–µ –ø—Ä–∏–º–µ–Ω–µ–Ω—ã –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏:**
   - Model: YOLOv8n (–ª–µ–≥–∫–∞—è)
   - Epochs: 25 (–º–µ–Ω—å—à–µ)
   - Image size: 384 (–º–µ–Ω—å—à–µ)
   - Mosaic: —É–º–µ–Ω—å—à–µ–Ω–∞

3. **–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏:**
   ```python
   close_mosaic = 0  # –ü–æ–ª–Ω–æ—Å—Ç—å—é –æ—Ç–∫–ª—é—á–∏—Ç—å mosaic
   plots = False     # –û—Ç–∫–ª—é—á–∏—Ç—å –≥—Ä–∞—Ñ–∏–∫–∏
   ```

---

## üí° –°–æ–≤–µ—Ç—ã –∏ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏

### –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö

‚úÖ **–•–æ—Ä–æ—à–æ:**
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –≥–æ—Ç–æ–≤—ã–µ –¥–∞—Ç–∞—Å–µ—Ç—ã (Roboflow, COCO)
- 3000+ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –¥–ª—è –æ–±—É—á–µ–Ω–∏—è
- –†–∞–≤–Ω–æ–º–µ—Ä–Ω–æ–µ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ø–æ –∫–ª–∞—Å—Å–∞–º
- –†–∞–∑–Ω–æ–æ–±—Ä–∞–∑–Ω—ã–µ —É—Å–ª–æ–≤–∏—è –æ—Å–≤–µ—â–µ–Ω–∏—è (–æ—Å–æ–±–µ–Ω–Ω–æ –¥–ª—è ExDark)

‚ùå **–ò–∑–±–µ–≥–∞—Ç—å:**
- –†–∞–∑–º–µ—Ç–∫–∞ –≤—Ä—É—á–Ω—É—é —Ç—ã—Å—è—á —Ñ—Ä–µ–π–º–æ–≤
- –°–ª–∏—à–∫–æ–º –º–∞–ª–µ–Ω—å–∫–∏–π –¥–∞—Ç–∞—Å–µ—Ç (<500 —Ñ—Ä–µ–π–º–æ–≤)
- –°–∏–ª—å–Ω–æ –Ω–µ—Å–±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –∫–ª–∞—Å—Å—ã

### –û–±—É—á–µ–Ω–∏–µ

‚úÖ **–•–æ—Ä–æ—à–æ:**
- Transfer Learning —Å COCO –≤–µ—Å–∞–º–∏
- Mixed Precision (AMP) –¥–ª—è —ç–∫–æ–Ω–æ–º–∏–∏ –ø–∞–º—è—Ç–∏
- Early stopping (patience=8)
- Validation –∫–∞–∂–¥—É—é —ç–ø–æ—Ö—É

‚ùå **–ò–∑–±–µ–≥–∞—Ç—å:**
- –û–±—É—á–µ–Ω–∏–µ —Å –Ω—É–ª—è
- –°–ª–∏—à–∫–æ–º –±–æ–ª—å—à–æ–π batch_size
- –ò–≥–Ω–æ—Ä–∏—Ä–æ–≤–∞–Ω–∏–µ validation loss
- `workers > 0` –Ω–∞ Windows –≤ Jupyter

### –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

‚úÖ **–î–ª—è –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–π —Å–∫–æ—Ä–æ—Å—Ç–∏:**

1. **–≠–∫—Å–ø–æ—Ä—Ç –≤ ONNX/TensorRT:**
   ```python
   model.export(format='onnx')  # –∏–ª–∏ 'engine' –¥–ª—è TensorRT
   ```

2. **–£–º–µ–Ω—å—à–µ–Ω–∏–µ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è:**
   ```python
   results = model('image.jpg', imgsz=320)  # –≤–º–µ—Å—Ç–æ 384
   ```

3. **–ü—Ä–æ–ø—É—Å–∫ —Ñ—Ä–µ–π–º–æ–≤ –≤ –≤–∏–¥–µ–æ:**
   ```python
   skip_frames=1  # –û–±—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å –∫–∞–∂–¥—ã–π 2-–π –∫–∞–¥—Ä
   ```

---

## üìà –ê–Ω–∞–ª–∏–∑ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤

### –ì—Ä–∞—Ñ–∏–∫–∏ –æ–±—É—á–µ–Ω–∏—è

–ü–æ—Å–ª–µ –æ–±—É—á–µ–Ω–∏—è –¥–æ—Å—Ç—É–ø–Ω—ã:

1. **Training/Validation Losses** - –¥–∏–Ω–∞–º–∏–∫–∞ –æ–±—É—á–µ–Ω–∏—è
2. **Precision & Recall** - —Ç–æ—á–Ω–æ—Å—Ç—å –∏ –ø–æ–ª–Ω–æ—Ç–∞
3. **mAP@0.5 & mAP@0.5:0.95** - –æ—Å–Ω–æ–≤–Ω—ã–µ –º–µ—Ç—Ä–∏–∫–∏
4. **Per-class mAP** - –º–µ—Ç—Ä–∏–∫–∏ –ø–æ –∫–∞–∂–¥–æ–º—É –∫–ª–∞—Å—Å—É

–í—Å–µ –≥—Ä–∞—Ñ–∏–∫–∏ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ `outputs/plots/training_results.png`

### Confusion Matrix

–ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç –∫–∞–∫–∏–µ –∫–ª–∞—Å—Å—ã –ø—É—Ç–∞—é—Ç—Å—è –º–µ–∂–¥—É —Å–æ–±–æ–π. –î–æ—Å—Ç—É–ø–Ω–∞ –ø–æ—Å–ª–µ –∑–∞–ø—É—Å–∫–∞ –≤–∞–ª–∏–¥–∞—Ü–∏–∏ –≤ notebook.

---

## üìö –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Ä–µ—Å—É—Ä—Å—ã

- [Ultralytics YOLOv8 Documentation](https://docs.ultralytics.com/)
- [Roboflow Universe](https://universe.roboflow.com/)
- [ExDark Dataset Paper](https://arxiv.org/abs/1805.11227)
- [PyTorch Documentation](https://pytorch.org/docs/)
- [YOLO Series Evolution](https://github.com/ultralytics/ultralytics)

---

## ‚úÖ –ß–µ–∫-–ª–∏—Å—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è —Ä–∞–±–æ—Ç—ã

- [x] –£—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã –≤—Å–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
- [x] –ü–æ–¥–≥–æ—Ç–æ–≤–ª–µ–Ω –¥–∞—Ç–∞—Å–µ—Ç ExDark (4718 –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π)
- [x] –°–æ–∑–¥–∞–Ω —Ñ–∞–π–ª data.yaml
- [x] –í—ã–ø–æ–ª–Ω–µ–Ω–∞ –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö
- [x] –ó–∞–ø—É—â–µ–Ω–æ –æ–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏ YOLOv8n
- [x] –î–æ—Å—Ç–∏–≥–Ω—É—Ç—ã –º–µ—Ç—Ä–∏–∫–∏: mAP@0.5 = 56.56%
- [x] –ü–æ—Å—Ç—Ä–æ–µ–Ω—ã –≥—Ä–∞—Ñ–∏–∫–∏ –æ–±—É—á–µ–Ω–∏—è
- [ ] –í—ã—á–∏—Å–ª–µ–Ω—ã –º–µ—Ç—Ä–∏–∫–∏ –Ω–∞ —Ç–µ—Å—Ç–æ–≤–æ–º –Ω–∞–±–æ—Ä–µ
- [ ] –í—ã–ø–æ–ª–Ω–µ–Ω–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∞ –≤–∏–¥–µ–æ
- [ ] –ù–∞–ø–∏—Å–∞–Ω—ã –≤—ã–≤–æ–¥—ã
- [x] –í—Å–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã –≤ `runs/detect/yolov8n_fast/`

---

## üë§ –ê–≤—Ç–æ—Ä

**–í—ã–ø–æ–ª–Ω–∏–ª:** –§–∞–∏–∑–æ–≤ –ê–ª–µ–∫—Å–∞–Ω–¥—Ä
**–ì—Ä—É–ø–ø–∞:** –ï–¢-313
**–î–∞—Ç–∞:** 2025-12-18

**–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è —Å–∏—Å—Ç–µ–º—ã:**
- GPU: NVIDIA GeForce RTX 3050 Ti (4GB)
- PyTorch: 2.7.1+cu118
- CUDA: 11.8
- Ultralytics: 8.3.240

---

## üìù –õ–∏—Ü–µ–Ω–∑–∏—è

–≠—Ç–æ—Ç –ø—Ä–æ–µ–∫—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω –≤ —É—á–µ–±–Ω—ã—Ö —Ü–µ–ª—è—Ö –≤ —Ä–∞–º–∫–∞—Ö –∫—É—Ä—Å–∞ –ø–æ –∫–æ–º–ø—å—é—Ç–µ—Ä–Ω–æ–º—É –∑—Ä–µ–Ω–∏—é.

---

## üéØ –í—ã–≤–æ–¥—ã

1. **–í—ã–±—Ä–∞–Ω–Ω–∞—è –º–æ–¥–µ–ª—å:** YOLOv8n –ø–æ–∫–∞–∑–∞–ª–∞ –æ—Ç–ª–∏—á–Ω—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã (mAP@0.5 = 56.6%) –ø—Ä–∏ –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏ –æ–±—É—á–µ–Ω–∏—è (~1 —á–∞—Å)

2. **–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏:** –ö–ª—é—á–µ–≤—ã–µ —Ñ–∞–∫—Ç–æ—Ä—ã —É—Å–∫–æ—Ä–µ–Ω–∏—è:
   - –õ–µ–≥–∫–∞—è –º–æ–¥–µ–ª—å (3.2M –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤)
   - –ú–µ–Ω—å—à–µ —ç–ø–æ—Ö (25 –≤–º–µ—Å—Ç–æ 100)
   - –ú–µ–Ω—å—à–µ–µ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–µ (384 –≤–º–µ—Å—Ç–æ 640)
   - –£–º–µ–Ω—å—à–µ–Ω–Ω—ã–µ –∞—É–≥–º–µ–Ω—Ç–∞—Ü–∏–∏

3. **–ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∞—è –ø—Ä–∏–º–µ–Ω–∏–º–æ—Å—Ç—å:**
   - –ú–æ–¥–µ–ª—å –ø—Ä–∏–≥–æ–¥–Ω–∞ –¥–ª—è real-time –¥–µ—Ç–µ–∫—Ü–∏–∏ (80-100 FPS)
   - –•–æ—Ä–æ—à–∞—è —Ç–æ—á–Ω–æ—Å—Ç—å (Precision = 67%)
   - –ü—Ä–∏–µ–º–ª–µ–º–∞—è –ø–æ–ª–Ω–æ—Ç–∞ (Recall = 50%)

4. **–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:**
   - –î–ª—è –ø—Ä–æ–¥–∞–∫—à–Ω –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å YOLOv8s –∏–ª–∏ YOLOv8m
   - –≠–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –≤ ONNX/TensorRT –¥–ª—è –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–π —Å–∫–æ—Ä–æ—Å—Ç–∏
   - –î–ª—è Windows –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `workers=0`

---

**üéâ –ü—Ä–æ–µ–∫—Ç —É—Å–ø–µ—à–Ω–æ –≤—ã–ø–æ–ª–Ω–µ–Ω!**
